SecDevOps Operations & Maintenance ProcedureDocument IDCAU-SOP-S-005ClassificationINTERNAL CONFIDENTIALVersion1.0 (Baseline)StatusAPPROVEDOwnerHead of SecDevOps (OPS-03)DepartmentOT SecDevOpsScopeCloud/On-Prem SCADA Fleet (200+ Nodes)Effective Date12 December 2025Next Review Date12 December 2026Document ControlRevision HistoryVersionDateAuthorDescription of Changes1.012 Dec 2025Head of SecDevOps (OPS-03)Initial Release. Extracted from [CAU-MAN-S-001].1. PurposeThe purpose of this procedure is to define the operational workflows for commissioning, maintaining, and responding to incidents within the Cloud/On-Prem SCADA fleet. It details the specific execution steps ("The How") to ensure compliance with the configuration standards defined in [CAU-STD-S-001].2. Commissioning & Provisioning Workflows2.1 OS Generation (Packer Build)Objective: Generate an immutable .img file for flashing onto physical hardware.Frequency: Monthly or upon Config Change.Packer Configuration: repo/packer/ubuntu-onprem.pkr.hcl (Refer to [CAU-STD-S-003] Section 3.1 for source code).Process:Build Trigger: Commit to main triggers GitHub Action build-os.yml.Secret Injection: Pipeline injects the current Reusable Tailscale Auth Key (tag:provisioning) via Cloud-Init.Artifact Generation: Packer outputs a QCOW2/IMG file.Distribution: Artifact uploaded to Azure Blob Storage (SAS Token generation).2.2 Zero-Touch Provisioning (ZTP)Objective: Bootstrap a bare-metal device into the fleet.Flash: Technician flashes onprem-node-v1.img to the device SSD.First Boot:Device boots and executes Cloud-Init.Runs tailscale up --authkey=[BAKED_KEY] --ssh --hostname=onprem-[ID].State: Device connects to Tailnet but is restricted by tag:provisioning (No Access).Approval Gate:Administrator logs into Tailscale Admin Console.Verifies Hostname matches physical deployment.Approves node and re-tags as tag:ignition-onprem.Completion: Device inherits production ACLs and pulls Docker Compose stack via Portainer.3. Routine Maintenance Procedures3.1 Certificate RotationObjective: Renew *.onprem.company.com SSL certificates.Trigger: Scheduled Cron (@monthly).Procedure:Execution: cert-renewer container starts on On-Prem Node.Challenge: Performs DNS-01 challenge via Azure DNS API.Deployment: Updates local certificate store.Restart: Invokes Portainer API to restart SCADA Gateway container.3.2 Automated Credential Rotation (Tailscale)Objective: Rotate the Provisioning Key used in the Packer build pipeline.Trigger: Scheduled Cron (@monthly).Workflow (rotate-keys.yml):Refer to [CAU-STD-S-003] Section 5.1 for the definitive pipeline configuration.Authentication: GitHub Action authenticates to Tailscale API v2.Generation: Creates new key with tag:provisioning (90-day max expiry).Update: Updates Repository Secret TAILSCALE_AUTH_KEY_PACKER.Validation: Triggers a "Canary" build to verify key efficacy.4. Incident Response Procedures4.1 "Break Glass" Commissioning ModeObjective: Enable temporary, audited internet egress for field diagnostics.Trigger: Azure Arc Run Command or SSH execution.Script Location: /usr/local/bin/break-glass.shScript Source: Refer to [CAU-STD-S-003] Section 7.1 for the authoritative script content.Execution Steps:Log Event: Script logs BREAK_GLASS_ACTIVATED to Syslog (triggers Sentinel Alert).Open Firewall: Executes ufw allow out to any port 80,443 proto tcp.Schedule Close: Schedules at job to revert rules in 30 minutes.4.2 Device IsolationObjective: Cut off a compromised device from the network.Trigger: Sentinel Logic App or Manual Admin Action.Procedure:Identify: Locate device in Microsoft Defender for Endpoint console.Action: Select "Isolate Device".Effect:Defender blocks all network traffic except connection to Defender Service.Tailscale ACLs (if still active) block lateral movement.Remediation: Dispatch technician for physical re-imaging (See Section 2.2).