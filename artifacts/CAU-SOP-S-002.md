Tailscale User Lifecycle Management SOPDocument IDCAU-SOP-S-002ClassificationINTERNAL CONFIDENTIALVersion1.0 (Baseline)StatusAPPROVEDOwnerHead of SecDevOps (OPS-03)DepartmentOT SecDevOpsEffective Date12 December 2025ComplianceISO 27001 (A.5.16, A.8.2, A.9.2.1, A.9.2.3)Next Review Date12 December 2026Document ControlRevision HistoryVersionDateAuthorDescription of Changes1.012 Dec 2025Head of SecDevOps (OPS-03)Baseline Release. Aligned to Policy CAU-POL-S-002.1. Purpose and Scope1.1 PurposeThis Standard Operating Procedure (SOP) defines the formal, auditable processes for managing the full identity lifecycle (onboarding, access review, offboarding) of all users accessing the Tailnet. It ensures that access is granted based on the Principle of Least Privilege and is rigorously authenticated via the corporate Identity Provider.1.2 ScopeThis SOP applies to the Platform Admin (OPS-03) responsible for managing user access. It governs three distinct user categories:Internal Staff: Permanent employees (managed via Entra ID Groups).External Guests: Consultants/Vendors (Time-bound).Site-to-Site Integrations: Permanent Customer connections (Network-bound).2. Roles and ResponsibilitiesRoleRole IDResponsibilitiesSecurity Compliance NoteRequestorN/AInitiates access requests via Planner.Must provide clear business justification.Approving ManagerOPS-03Verifies business need and budget.Enforces separation of duties.Tailscale AdminOPS-03Executes provisioning, ACL updates, and revocations.Accountable for policy adherence.Customer ApproverEXT-XXConditionally reviews ACLs affecting their tenant.Provides sign-off for shared security responsibility.3. Internal Staff Lifecycle (ISO 27001 A.9.2)Policy Mandate: Internal access SHALL be managed via Microsoft Entra ID Security Groups. Direct assignment of users to ACLs or manual role assignment in the console is prohibited (Ref: [CAU-POL-S-002]).3.1 Onboarding and ProvisioningInitiation: Requestor submits a task in the "Tailscale Change Management" bucket in Microsoft Planner.Required: Staff Name, Role (Viewer/Engineer), Justification.Approval: Approving Manager marks the Planner task as "Approved".Execution (OPS-03):Action: Add the user to the appropriate Entra ID Group. This action triggers SCIM Provisioning to the Tailscale Console.SEC-OT-OPS-01-VIEW maps to Tailscale Group group:viewers (Role: Member).SEC-OT-OPS-02-ENG maps to Tailscale Group group:engineers (Role: Member).SEC-OT-OPS-03-ADMIN maps to Tailscale Group group:admins (Role: Admin).Verification: Confirm the user appears in the Tailscale "Users" list with the correct "Synced Group" badge within 15 minutes.Audit: Comment "Provisioned via SCIM" on the Planner task and move to "Completed".3.2 Access Rights Review (Recertification)Frequency: Every 180 Days.Process: Drata triggers an automated review of Entra ID Group memberships.Action: OPS-03 removes any staff who have changed roles or left the project from the Entra ID group.3.3 OffboardingTrigger: HRIS notification or Service Desk Ticket.Action: Remove user from the SEC-OT-OPS-XX Entra ID group.Result: Tailscale SCIM automatically suspends the user. Active device sessions are terminated immediately.4. Temporary External Guest Lifecycle (ISO 27001 A.9.2.6)This process applies to consultants or vendors requiring Time-Bound access where SCIM integration is not feasible.4.1 OnboardingInitiation: Requestor submits a Planner task detailing:Guest Email (Must be corporate address; Gmail/Hotmail prohibited).Target Resource (Specific IP/Tag).Expiry Date (Max 90 Days).Execution (OPS-03):Invite user via Tailscale Console to a specific ACL Tag (e.g., tag:guest-vendor-x).Mandatory: Configure expiry date in the user invite or ACL rule.ACL Configuration:If a new ACL rule is required, follow the Change Management Workflow defined in [CAU-SOP-S-003] (Planner -> Jira -> GitOps).Rule: Guests MUST be isolated using src: ["tag:guest-vendor-x"].4.2 Expiry & RecertificationMonitoring: Drata tracks the expiry date of all Guest accounts.Revocation: Access is strictly time-limited. Renewal requires a new approved Planner request.5. Permanent Customer (Site-to-Site) LifecycleThis process governs permanent tunnels for project delivery or remote support.5.1 ProvisioningDesign: Project Delivery Team defines the connectivity requirements (Subnets/PLCs).Identity: Customers shall NOT interactively log in to the Tailnet. Connectivity is established via Headless Auth Keys on On-Prem Gateways (Site-to-Site).Execution (OPS-03):Generate a pre-authenticated Auth Key tagged with a unique Project ID (e.g., tag:cust-site-a).Configure ACLs to enforce Tenant Isolation:{"action": "accept", "src": ["tag:cust-site-a"], "dst": ["tag:cust-site-a"], "isolation": true}Customer Sign-off: (Optional) Provide a sanitised connection diagram to the Customer Approver for confirmation.5.2 OffboardingTrigger: Contract termination.Action:Revoke the Auth Key in Tailscale Console.Remove the tag:cust-site-a definition from policy.hujson via GitOps PR.6. ACL Change Control (ISO 27001 A.14.2)All changes to Access Control Lists (ACLs) required to support user access MUST follow the High-Risk Change Workflow defined in [CAU-SOP-S-003].Mandatory Group Syntax: ACL rules SHALL reference Entra ID synced groups (e.g., group:sec-ot-ops-02-eng) rather than individual user email addresses.Summary of Mandatory Workflow:Stage 1: Planner Request.Stage 2: Jira Change Request (Admin formalisation).Stage 3: GitHub Pull Request (Technical Execution & Validation).Stage 4: Automated Deployment via GitHub Actions.Manual editing of ACLs in the Web Console is STRICTLY PROHIBITED.7. Audit & Compliance7.1 Compliance Monitoring (Drata)User Review: Drata monitors evidence of the 180-day review cycle.Guest Expiry: Drata alerts on Guest accounts active > 90 days.Approval Evidence: Planner Task IDs and Jira CR numbers serve as the immutable evidence of authorisation.7.2 Log ReviewThe Administrator SHALL review Tailscale Audit Logs monthly to verify:No direct user creation occurred outside of Entra ID SCIM.No node approvals occurred without a valid Ticket ID.