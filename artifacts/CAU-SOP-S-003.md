Tailscale ACL Change Management SOPDocument IDCAU-SOP-S-003ClassificationINTERNAL CONFIDENTIALVersion1.0 (Baseline)StatusAPPROVEDOwnerHead of SecDevOps (OPS-03)DepartmentOT SecDevOpsEffective Date12 December 2025ComplianceISO 27001 (A.12.1.2, A.14.2)Next Review Date12 December 2026Document ControlRevision HistoryVersionDateAuthorDescription of Changes1.012 Dec 2025Head of SecDevOps (OPS-03)Baseline Release (Approved). Aligned to OPS-xx Role Model.1. Purpose and ObjectivesThis procedure defines the mandatory workflow for modifying the Tailscale Access Control List (ACL) configuration (policy.hujson). It enforces a rigorous GitOps-based Change Management process to ensure that all network segmentation and access changes are:Authorized: Approved by designated personnel (Separation of Duties).Validated: Syntactically correct and logically consistent with Zero Trust principles.Auditable: Traceable to specific change tickets and user identities for GRC compliance (Drata).2. ScopeThis SOP applies to all modifications of the Tailnet configuration, including but not limited to:ACL Rules: acls, ssh, and tests blocks.Identity Definitions: groups, tagOwners, and hosts definitions.System Settings: nodeAttrs and capability assignments.Exclusions:User provisioning/deprovisioning (Refer to [CAU-SOP-S-002]).3. Change Classification FrameworkAll ACL modifications must be categorized to determine the required approval workflow.3.1 Standard Change (Low Risk)Changes that do not materially alter the security posture or attack surface.Scope:Adding comments or documentation within the HuJSON file.Refactoring code structure without logic changes (e.g., reordering lists).Adding a new node to an existing, approved Tag where the Tag's permissions are already defined.Approval Requirement: Peer Review (OPS-02 Engineer or higher).3.2 Major Change (High Risk)Changes that modify traffic flow, exposure, or privilege levels.Scope:Creation or deletion of Tags (tag:new-service).Modification of Groups (adding/removing members).Any modification to the acls or ssh blocks (allowing new ports, sources, or destinations).Changes to autoApprovers or admin console settings.Approval Requirement:Technical Review: Platform Admin (OPS-03).Governance Approval: Head of SecDevOps (if different from Admin).4. Procedure: GitOps Change WorkflowPhase 1: Initiation and BranchingTicket Creation: A Change Request (CR) ticket must be created in the Project Management System (e.g., Jira/Planner). The ticket must detail:Business Justification: Why is this access required?Source/Destination: Specific CIDR, Tag, or User.Protocol/Port: Minimal required ports (e.g., tcp/443, tcp/502).Repository Sync: The Engineer shall pull the latest main branch of the tailscale-acl repository.Branch Creation: Create a feature branch following the syntax: feature/CR-{TICKET_ID}-description.Example: feature/CR-1042-scada-hmi-access.Phase 2: Configuration and SyntaxEdit Configuration: Modify policy.hujson.Syntax Constraint: Use HuJSON (Human JSON) allowing comments.Comment Requirement: Every rule modification must include a trailing comment referencing the CR Ticket ID.// CR-1042: Allow HMI to poll PLC via Modbus
{ "action": "accept", "src": ["tag:hmi"], "dst": ["tag:plc:502"] }
Local Validation: Run the local ACL test suite to verify syntax and regression testing.tailscale debug acl --test-file=tests.hujson (if available locally) or use the VS Code Tailscale extension validator.Phase 3: Pull Request and Review (ISO 27001 A.14.2.3)PR Submission: Push the branch and open a Pull Request (PR) to main.Automated CI Checks: The CI pipeline (GitHub Actions) shall automatically:Validate HuJSON syntax.Run the tests block defined in the policy against the proposed changes.Failure Condition: If CI fails, the PR is strictly blocked.Peer Review:Reviewer checks against Zero Trust principles (Source: [CAU-POL-S-001]).Reviewer verifies Least Privilege.Reviewer confirms Ticket Association (CR ID is present).Approval:Standard Change: Requires 1 approval (OPS-02 Engineer).Major Change: Requires 2 approvals (1x OPS-02 Engineer + 1x OPS-03 Admin).Phase 4: Deployment and VerificationMerge & Apply: Upon merging to main, the CI/CD pipeline typically applies the policy via the Tailscale API.Manual Fallback: If automation is unavailable, an OPS-03 Admin must manually copy the JSON to the Tailscale Admin Console. This is a deprecated method and must be logged as an exception.Verification: The Requestor must verify connectivity immediately.Closure: Update the CR ticket to "Resolved" with a link to the merged PR commit hash.5. Emergency Rollback ProceduresIn the event of a network partition or critical security failure caused by an ACL change:Identify: confirm the outage is ACL-related via tailscale netcheck or firewall logs.Revert: The OPS-03 Admin shall immediately execute git revert {BAD_COMMIT_HASH} on the main branch.Force Push/Apply: Merge the revert PR immediately (bypassing standard review if operational impact is Critical).Post-Mortem: A Root Cause Analysis (RCA) is mandatory for any emergency rollback event.6. Audit and Compliance (Drata Integration)To satisfy ISO 27001 A.12.1.2 and A.12.4.1:Evidence Collection: The Git Commit History acts as the immutable audit log.Drata Sync:The Security Lead must link the specific GitHub Pull Request to the Drata control evidence for "System Change Control."Ensure the PR description includes the "Risk Analysis" and "Test Plan" details required by the ISMS.7. Logic/Syntax Reference (Standardized)Wildcards: Use of * is strictly prohibited in dst ports for Level 1, 2, and 3 users.Tags: All machine users MUST use Tags (tag:server). Users MAY use Groups (group:admin).Tests: The tests block in the ACL file is mandatory. Every new action: accept rule requires a corresponding src -> dst = accept test case, and at least one src -> dst = deny (negative test) case.